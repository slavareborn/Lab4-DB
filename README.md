# Бібліотечна система баз даних

Проект демонструє роботу з реляційною базою даних бібліотеки з використанням різноманітних SQL-запитів для аналізу та управління даними.

## Структура проекту

- `docker-compose.yml` — конфігурація контейнера для запуску СУБД
- `init-scripts/init.sql` — скрипт ініціалізації таблиць бази даних
- `init-scripts/select.sql` — колекція SELECT-запитів для аналізу даних

## Описи запитів

### 1. Рейтинг найактивніших читачів
**Що робить:** Показує 2 найактивніших читачів, які брали найбільше книг.

**Технологія:**
- `INNER JOIN` — об'єднання таблиць Member і Loan
- `COUNT(l.Loan_ID)` — агрегація: підрахунок кількості позичень
- `GROUP BY` — угрупування за читачем
- `ORDER BY DESC LIMIT 2` — сортування за спаданням і вибір топ-2

### 2. Читачі зі штрафами більше 50 грн
**Що робить:** Списує читачів, які мають штрафи на суму більше 50 гривень, та їхні контактні дані.

**Технологія:**
- `JOIN Fine` — з'єднання з таблицею штрафів
- `SUM(f.Amount)` — агрегація: сумування штрафів
- `GROUP BY` — угрупування за читачем
- `HAVING SUM(f.Amount) > 50` — фільтрація по агрегованих даних

### 3. Прострочені повернення книг
**Що робить:** Показує книги, які були позичені, не повернені вчасно, та інформацію про читача й бібліотекаря.

**Технологія:**
- Чотири `JOIN` операції — об'єднання таблиць Loan, Book, Member, Staff
- `(CURRENT_DATE - l.DueDate)` — обчислення кількості днів прострочення
- `WHERE l.ReturnDate IS NULL AND l.DueDate < CURRENT_DATE` — фільтрація активних прострочених позичень

### 4. Книги, які наразі не позичені
**Що робить:** Список всіх книг, які знаходяться в бібліотеці (не видані читачам).

**Технологія:**
- `LEFT JOIN Loan` — лівосторонній вибір всіх книг, навіть тих без позичень
- `WHERE l.Loan_ID IS NULL` — фільтрація: відбір лише книг без активних позичень
- Додаткові JOIN з Author та Genre для отримання інформації про автора і жанр

### 5. Категоризація книг за ціною
**Що робить:** Розподіляє книги по цінових категоріях.

**Технологія:**
- `CASE WHEN...THEN...END` — умовна логіка для категоризації:
  - Менше 200 грн — "Бюджетна"
  - 200-500 грн — "Середня ціна"
  - Більше 500 грн — "Дорога/Рідкісна"

### 6. Загальна кількість назв книг
**Що робить:** Показує загальну кількість унікальних книг в бібліотеці.

**Технологія:**
- `COUNT(*)` — агрегація: підрахунок всіх записів

### 7. Сума всіх штрафів
**Що робить:** Обчислює загальну суму штрафів, накладених на всіх читачів.

**Технологія:**
- `SUM(Amount)` — агрегація: сумування всіх штрафів

### 8. Середня ціна книги
**Що робить:** Розраховує середню вартість книги в колекції.

**Технологія:**
- `AVG(Cost)` — агрегація: обчислення середнього значення
- `ROUND(..., 2)` — округлення до 2 знаків після коми

### 9. Найстаріша книга (рік видання)
**Що робить:** Знаходить рік видання найстарішої книги в колекції.

**Технологія:**
- `MIN(PublisherYear)` — агрегація: мінімальне значення року

### 10. Книга з максимальною кількістю сторінок
**Що робить:** Визначає найбільший обсяг серед книг у бібліотеці.

**Технологія:**
- `MAX(AmountOfPages)` — агрегація: максимальне значення сторінок

## Ключові концепції SQL, що використовуються

| Концепція | Описание |
|-----------|---------|
| **INNER JOIN** | Об'єднання таблиць — вибирає лише рядки з збігами в обох таблицях |
| **LEFT JOIN** | Лівосторонній вибір — зберігає все з лівої таблиці, додаючи дані з правої |
| **GROUP BY** | Угрупування — розбивання результатів на групи для агрегації |
| **Агрегаційні функції** | COUNT, SUM, AVG, MIN, MAX — обчислення над групами даних |
| **HAVING** | Фільтрація — обмеження груп по агрегованих значеннях |
| **CASE WHEN** | Умовна логіка — розгалужена обробка даних |
| **WHERE** | Фільтрація — обмеження рядків до виконання групування |
